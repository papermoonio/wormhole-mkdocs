# Scripts for Autogenerating Content

The scripts in this directory automate the generation and insertion of blockchain-specific content into documentation files. The content that gets automatically generated is as follows:

- The supported chains
- The Wormhole chain ID table
- Each of the contract addresses tables
- The finality/consistency level table

## Understand How the Scripts Work

The scripts perform two major actions:

1. **Generates chain data**: Using the Wormhole SDK, the scripts collect details about the supported chains and then create formatted tables based on this chain data.
2. **Inserts generated content**: It finds specific `<!--tag-->` comments in the documentation files and replaces the content between these tags with the newly generated HTML, markdown, or data tables. The script looks specifically in the `.snippets/text` directory for these tags. If you add new tables, also create the tag in that directory.

This process keeps the docs up to date with minimal manual work by dynamically generating and injecting relevant data.

> Note: By default, the scripts target `../wormhole-docs/.snippets/text`. If your docs live elsewhere and the code has been parameterized, set `DOCS_SNIPPETS_DIR` to point to your snippets folder.

## Generate Updated Content: Run the Scripts

Before you can generate the content, you'll need to ensure you have the [`wormhole-docs` repository](https://github.com/wormhole-foundation/wormhole-docs) nested inside of the `wormhole-mkdocs` repository.

Next, change to the `scripts` directory and install dependencies:

```sh
cd scripts && npm i
```

Safely bump dependencies:

```sh
npm run update
```

Generate the content:

```sh
npm run generate
```


Now you can review the changes in the `wormhole-docs` repo and open a PR with those updates.

## Update Chain Configurations

To update chain configurations, such as chain IDs, finality levels, explorers, faucets, and more, modify the JSON chain file in the `scripts/src/chains/` directory. There is one file per supported chain.

The information from the chain files is used in the blockchain environment pages. The `title` parameter is also used in the Supported Networks and Reference pages. If you modify the `title`, keep it human‑readable, with proper spacing between words (e.g., `Base Sepolia`).

## Autogenerated Product Support Tables

The `generate` script also creates **product support tables** for the following Wormhole components:

- Connect
- NTT
- WTT (Token Bridge)
- CCTP
- Settlement
- MultiGov

Each product's support table lists the compatible blockchains across mainnet, testnet, and (optionally) devnet. These tables are injected into the `.snippets/text` directory and reused across multiple documentation pages.

### How product support is determined

We are SDK-first. For most products the tables are built directly from the Wormhole SDK. No local config is needed in those cases.

- Token Bridge (WTT), Settlement, MultiGov, and Connect → SDK only. The SDK already exposes the contracts/ids we need, so we render straight from that data.
- CCTP and NTT are config-driven. For these two we read the table inputs from specific source files listed in product-support-config.json instead of using the generic SDK helper.

NTT also uses a filter file (per WH request). We first collect all candidate chains from the listed NTT files, then we keep only the chains that also appear in the filter file’s constants (strict allow-list). Anything not present in the filter is dropped.

### Product Support Config (`scripts/src/config/product-support-config.json`)

This config is only used today for CCTP and NTT. It tells the generator which files to read to build those tables and (for NTT) which file to use as a strict filter. Each entry describes one product.

**Fields**

- `product`: Display label used for logs and default constant guesses (e.g., `"NTT"`, `"CCTP"`).
- `url` / `urls`: SDK source file(s) that export the `*Contracts` arrays. Use raw GitHub URLs or local paths.
- `consts` (optional): Exact constant names to read from the product sources above. If omitted, the script guesses typical names for that product.
- `filterUrls` (optional): Additional SDK files used to build a **strict allow‑list**.
- `filterConsts` (optional but recommended with `filterUrls`): Constant names to read from those allow‑list files. If a `filterUrl` does **not** contain these constants, that file is **ignored** for filtering (fail‑closed).
- `excludeChains` (optional): Chains to drop by name (case‑insensitive).
- `manualAdd` (optional): Chains to force‑include after filtering and excludes. Useful for Solana/Sui style cases that aren't in an EVM constant.
- `customChains` (optional): Seed values to start from. The normal filter/exclude/manualAdd steps still apply.
- `outputFile`: Path (under `src/generated/`) where the script writes the final JSON for this product.

**Example**

```json
[
  {
    "product": "NTT",
    "urls": [
      "https://raw.githubusercontent.com/.../relayer.ts",
      "https://raw.githubusercontent.com/.../executor.ts"
    ],
    "consts": ["relayerContracts", "executorContracts"],
    "filterUrls": [
      "https://raw.githubusercontent.com/.../core.ts"
    ],
    "filterConsts": ["coreBridgeContracts"],
    "excludeChains": ["Aptos"],
    "manualAdd": {
      "Mainnet": ["Solana"],
      "Testnet": ["Solana", "Sui"]
    },
    "outputFile": "./src/generated/ntt-support.json"
  },
  {
    "product": "CCTP",
    "url": "https://raw.githubusercontent.com/.../circle.ts",
    "consts": ["usdcContracts"],
    "outputFile": "./src/generated/cctp-support.json"
  }
]
```

**Notes**

- Filtering is **strict** when `filterUrls`/`filterConsts` are set: we keep **only** chains that appear in those filter constants. Missing filter constants in a file → that file is ignored (we do not widen the allow‑list).
- `excludeChains` is enforced after `manualAdd`, so excludes always win.
- Output is sorted and only written if changed, to keep PRs clean (if this optimization is enabled in the generator).

### Adding or changing a product

1. Edit `scripts/src/config/product-support-config.json` and add/update the product entry.
2. Point `url`/`urls` to the SDK files that declare the product’s `*Contracts` arrays.
3. (Recommended) Add `filterUrls` + `filterConsts` to constrain to chains with required core contracts.
4. Pick an `outputFile` under `src/generated/`.
5. Run `npm run generate` and review the changes.

## Troubleshooting

- **A tag didn't update**: Make sure both opening and closing `<!--TAG-->` markers exist in the same file and match exactly.
- **Unexpected chains in a product table**: Check `filterUrls`/`filterConsts`, `excludeChains`, and `manualAdd` in the config file.
- **Slow runs**: Prefer local paths over network URLs in the config during development. The generator also avoids rewriting files when the content is unchanged.
- **Wrong chain title in tables**: Fix the `title` field in `scripts/src/chains/<Chain>.json`.

---

If you need to add new generated tables, keep the same pattern: render the table, add a new `<!--tag-->` in `.snippets/text`, and let the injector do the rest.
